<style>
    .table-container {
        max-height: 500px; /* Set maximum height */
        overflow-y: auto;  /* Enable vertical scrolling when needed */
        border: 1px solid #ddd;
    }

    /* Table Styling */
    table {
        width: 100%;
        border-collapse: collapse;
    }

    /* Sticky Header */
    thead {
        position: sticky;
        top: 0;
        background-color: rgb(255, 255, 255);
        z-index: 2;
    }

    th, td {
        padding: 10px;
        text-align: center;
        border-bottom: 1px solid #ddd;
    }

    /* Alternating row colors */
    tbody tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    tbody tr:hover {
        background-color: #c9c7c7;
    }
    
</style>

<!-- Table Container -->
<div class="table-container">
    <table id="productTable">
        <thead>
            <tr>
                <th>Brand</th>
                <th>Model</th>
                <th>Size</th>
                <th>Color</th>
                <th>Helmet Type</th>
                <th>Visor Type</th>
                <th>Price</th>
                <th>Quantity</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<script>
    function loadProducts() {
    fetch("/get-products/")
    .then(response => response.json())
    .then(data => {
        let tableBody = document.querySelector("#productTable tbody");
        tableBody.innerHTML = "";

        if (!data || !Array.isArray(data)) {
            console.error("❌ Invalid JSON format:", data);
            return;
        }

        data.forEach(item => {
            let row = `<tr 
                data-brand="${item.brand.toLowerCase()}"
                data-color="${item.color ? item.color.toLowerCase() : ''}"
                data-size="${item.size.toLowerCase()}"
                data-type="${item.helmet_type.toLowerCase()}"
                data-visor="${item.visor_type.toLowerCase()}"
                data-price="${item.price || 0}"
                data-in-stock="${item.quantity > 0}">
                <td>${item.brand}</td>
                <td>${item.model}</td>
                <td>${item.size}</td>
                <td>${item.color || "N/A"}</td>
                <td>${item.helmet_type}</td>
                <td>${item.visor_type}</td>
                <td>₱${item.price ? item.price.toLocaleString() : "N/A"}</td>
                <td>${item.quantity}</td>
            </tr>`;
            tableBody.innerHTML += row;
        });

        applyFilters(); // Apply filters after loading products
    })
    .catch(error => console.error("❌ Error loading products:", error));
}

    // Load products on page load
    window.onload = loadProducts;

    setInterval(loadProducts, 5000); // Reloads every 5 seconds
</script>
